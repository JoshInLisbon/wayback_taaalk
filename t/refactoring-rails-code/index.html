<!DOCTYPE html>
<html>
  <head>
    <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
    <link href="https://fonts.googleapis.com/css?family=Roboto:400,700&display=swap" rel="stylesheet">
    <title>Taaalk | Refactoring Rails Code - Kent Slaymaker, Jaryl Sim &amp; Joshua Summers</title>
        <meta id="meta" name="js-loader" content="tlks-show" >
    <meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="mgzWKrOsNmwv0f8ajpQG6wLB6fR3F67MlL7Hz8m0DIy60y5Xz8qsFpBliL0EUF+g796OAlhIdnVR+KjOD9RB5g==" />
    
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="/packs/js/application-9c414d76ef68f0456f95.js" data-turbolinks-track="reload"></script>
    <link rel="stylesheet" media="all" href="/assets/application-40181b187553227631c8f4df1d7000634685c11b6ef454fe80c408b8da3ccf34.css" data-turbolinks-track="reload" />
    <link rel="shortcut icon" type="image/x-icon" href="/assets/favicon-d3e220a5d00985ec7043ba5c160cac8a73df50fba21d2fbb684af206efe8eca3.ico" />
  </head>

  <body>
    <nav class="navbar navbar-light">

  <a class="navbar-brand tlk-brand" href="/">Taaa<span class='fc-logo'>l</span>k</a>

  <div class="navbar-non-logo">
    <div class="nav-btn-holder">
      <a href="/start-conversation">
        <div class="nav-btn ">
        <i class="fas fa-align-left"></i>Start a Conversation
        </div>
</a>    </div>


    <div class="nav-btn-holder">

        <a href="/users/sign_in">
        <div class="nav-btn login-btn">
          Log In
        </div>
</a>    </div>
  </div>
</nav>

    <div class="calc-height-navbar">
      
  <div id="tlk-section-read">
    
<div class="tlk-image bg-purp"
  style="background-image: linear-gradient(rgba(0,0,0,0.4), rgba(0,0,0,0.4)), url(/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBZEE9IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--1ddff04bd4f56d88834475fb7aa36e96edbd9743/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2RkhKbGMybDZaVjkwYjE5c2FXMXBkRnNIYVFKQUJqQTZFR0YxZEc5ZmIzSnBaVzUwVkRvTVozSmhkbWwwZVVraUMyTmxiblJsY2dZNkJrVlUiLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--25fddff6bdb0fe960586d897c16d7c7709ec405e/code-refactoring-1024x455.jpg);
  background-size: cover;
  background-repeat: no-repeat;
  background-position: center;"
>
  <h1 class="tlk-title">Refactoring Rails Code</h1>

</div>


<div class="tlk-container">

    <div class="spkr-color-120">
      <div class="msg-70">
        <div class="spkr-info spkr-info-left">
          <div class="spkr-image-and-name">
            <div class="spkr-bio-image spkr-image image-spkr-120"
                style="background-image: url(/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBYdz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--b12355bc47dd05a966918b8f6edea2442e056d46/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2QzNKbGMybDZaVWtpRFRFd05IZ3hNRFJlQmpvR1JWUTZFR0YxZEc5ZmIzSnBaVzUwVkRvTVozSmhkbWwwZVVraUMyTmxiblJsY2dZN0IxUT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--cccc2840663003c8560dd0321607ac1c663d4500/IMG-20200426-WA0002.jpg)"
              >
            </div>
            <div>
              <h3><a class="name-spkr-120" href="/u/joshua-summers">Joshua Summers</a></h3>
              <div id="twitter-handle-div-120">
                  <a id="twitter-handle-120" class="twitter-handle" href="https://twitter.com/JoshSummers1234"><i class="fab fa-twitter"></i> JoshSummers1234</a>
              </div>
            </div>
          </div>
          <div class="spkr-biog-holder-tlk-left">
            <div class="spkr-biog biog-spkr-120">
              <div class="spkr-biog-left spkr-biog-present">
                <div class="trix-content">
  <div>I'm an early stage RoR developer who is looking to move away from my heavy controllers/skinny models thinking.</div>
</div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="spkr-color-121">
      <div class="msg-9">
        <div class="spkr-info spkr-info-right">
          <div class="spkr-image-and-name">
            <div class="spkr-bio-image spkr-image image-spkr-121"
                style="background-image: url(https://taaalk.co/assets/user-fb72496d9b86b96d0eaa9cb88d48193837d6d2693e24a554c078f5a78c7a86d9.svg)"
              >
            </div>
            <div>
              <h3><a class="name-spkr-121" href="/u/kent-slaymaker">Kent Slaymaker</a></h3>
              <div id="twitter-handle-div-121">
              </div>
            </div>
          </div>
          <div class="spkr-biog-holder-tlk-right">
            <div class="spkr-biog biog-spkr-121">
              <div class="spkr-biog-left spkr-biog-present">
                <div class="trix-content">
  <div>I love building things! That means coding, baking, carpentry, cheesemaking, winemaking, etc...Â </div>
</div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="spkr-color-122">
      <div class="msg-10">
        <div class="spkr-info spkr-info-left">
          <div class="spkr-image-and-name">
            <div class="spkr-bio-image spkr-image image-spkr-122"
                style="background-image: url(https://taaalk.co/assets/user-fb72496d9b86b96d0eaa9cb88d48193837d6d2693e24a554c078f5a78c7a86d9.svg)"
              >
            </div>
            <div>
              <h3><a class="name-spkr-122" href="/u/jaryl-sim">Jaryl Sim</a></h3>
              <div id="twitter-handle-div-122">
                  <a id="twitter-handle-122" class="twitter-handle" href="https://twitter.com/jaryl"><i class="fab fa-twitter"></i> jaryl</a>
              </div>
            </div>
          </div>
          <div class="spkr-biog-holder-tlk-left">
            <div class="spkr-biog biog-spkr-122">
              <div class="spkr-biog-left spkr-biog-present">
                <div class="trix-content">
  <div>I'm a long-time rails dev, and am currently interested in building federated apps/services.</div>
</div>

              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

</div>

  </div>


<div class="tlk-follow-div">
    <div class="tlk-container">
    <a class="tlk-follow-link link-txt" data-remote="true" rel="nofollow" data-method="post" href="/tlks/72/tlk_follows?spkrs_follow=true">
    Follow this Taaalk
</a>    <div class="tlk-note tlk-follow-note">
      <p>5 followers</p>
    </div>
    <div class="tlk-note tlk-follow-note tlk-views-note" style="margin-left: 3px;">
      <p>1,630 views</p>
    </div>
</div>

</div>

<div class="tlk-container">
<div class="big-blue-split"></div>
</div>


  <div class="tlking-container">

      <div class="tlk-blob tlk-blob-left" id="1" >
        <div class="tlk-blob-spkr">
          <div class="tlk-tlking-image spkr-image image-spkr-120"
              style="background-image: url(/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBYdz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--b12355bc47dd05a966918b8f6edea2442e056d46/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2QzNKbGMybDZaVWtpRFRFd05IZ3hNRFJlQmpvR1JWUTZFR0YxZEc5ZmIzSnBaVzUwVkRvTVozSmhkbWwwZVVraUMyTmxiblJsY2dZN0IxUT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--cccc2840663003c8560dd0321607ac1c663d4500/IMG-20200426-WA0002.jpg)"
            >
          </div>
          <div class="name-spkr-120 tlk-blob-name">Joshua Summers</div>
          <div class="tlk-blob-date">13:06, 27 Jul 20</div>
        </div>
        <div class="spkr-color-120">
          <div class="msg-70" target="spkr-color-">
            <div class="tlk-blob-msg"><div class="trix-content">
  <div class="tlk-bubble-holder"><div class="tlk-bubble">(All code being discussed can be found here: <a href="https://github.com/JoshInLisbon/taaalk_edge">https://github.com/JoshInLisbon/taaalk_edge</a>)</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">Just some clarity on terms used in the code before we begin:</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble"><ul>
<li>A Tlk is a Taaalk. It belongs to a User</li>
<li>A Spkr is a Speaker, which is a participant of a Taaalk. A Spkr belongs to a Tlk and a User.</li>
<li>A Msg is a message in a Taaalk. A Msg belongs to a Tlk, a User and a Spkr.</li>
</ul></div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">Before we get into looking at my heavy controllers, when it comes to my models, am I overdoing the 'belongs_to' and 'has_many'?</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">For example, here is my Tlk model:</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble"><pre>class Tlk &lt; ApplicationRecord
  belongs_to :user
  has_many :spkrs, dependent: :destroy
  has_many :msgs, dependent: :destroy
  has_many :tlk_follows, dependent: :destroy
  has_many :draft_msgs, dependent: :destroy

  has_one_attached :image

  validates :title, presence: true

  def any_published_msgs?
    msgs.find_by(published: true).present?
  end

  def all_spkrs
    spkrs.sort_by(&amp;:created_at)
  end

  def non_hidden_spkrs
    spkrs.where(hide: false).sort_by(&amp;:created_at)
  end

  def non_tlk_user_spkrs
    spkrs.where.not(user: self.user).sort_by(&amp;:created_at)
  end

  extend FriendlyId
  friendly_id :slug_candidates, use: :slugged

  def slug_candidates
    [
      :title,
      [:title, DateTime.now.to_date]
    ]
  end
end</pre></div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">Is that a bit clumsy as if Msgs belong_to Spkrs, and Spkrs belong_to Tlks, do I need to state the obvious again here? Or is that ok?</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">And if I were to one day use a list of Tlks to pull messages from, for example if I wanted to show the latest message of each Tlk on the tlk index page, would it matter if Msgs didn't belong_to Tlks directly?</div></div>
</div>

            </div>
          </div>
        </div>
      </div>
      <div class="tlk-blob tlk-blob-right" id="2" >
        <div class="tlk-blob-spkr">
          <div class="tlk-tlking-image spkr-image image-spkr-121"
              style="background-image: url(https://taaalk.co/assets/user-fb72496d9b86b96d0eaa9cb88d48193837d6d2693e24a554c078f5a78c7a86d9.svg)"
            >
          </div>
          <div class="name-spkr-121 tlk-blob-name">Kent Slaymaker</div>
          <div class="tlk-blob-date">14:26, 27 Jul 20</div>
        </div>
        <div class="spkr-color-121">
          <div class="msg-9" target="spkr-color-">
            <div class="tlk-blob-msg"><div class="trix-content">
  <div class="tlk-bubble-holder"><div class="tlk-bubble">Hey there!</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">First of all, congrats! You already have a functional website that a few people use. That is way further than many personal projects ever get.Â </div></div>
</div>

            </div>
          </div>
        </div>
      </div>
      <div class="tlk-blob tlk-blob-right" id="3" >
        <div class="tlk-blob-spkr">
          <div class="tlk-tlking-image spkr-image image-spkr-121"
              style="background-image: url(https://taaalk.co/assets/user-fb72496d9b86b96d0eaa9cb88d48193837d6d2693e24a554c078f5a78c7a86d9.svg)"
            >
          </div>
          <div class="name-spkr-121 tlk-blob-name">Kent Slaymaker</div>
          <div class="tlk-blob-date">14:29, 27 Jul 20</div>
        </div>
        <div class="spkr-color-121">
          <div class="msg-9" target="spkr-color-">
            <div class="tlk-blob-msg"><div class="trix-content">
  <div class="tlk-bubble-holder"><div class="tlk-bubble">You asked if you are too heavy on relationships between models. This is far from the heaviest I've seen.Â </div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">That being said, do you have any kind of diagram that shows the relationships? Like a UML or something?Â </div></div>
</div>

            </div>
          </div>
        </div>
      </div>
      <div class="tlk-blob tlk-blob-left" id="4" >
        <div class="tlk-blob-spkr">
          <div class="tlk-tlking-image spkr-image image-spkr-120"
              style="background-image: url(/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBYdz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--b12355bc47dd05a966918b8f6edea2442e056d46/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2QzNKbGMybDZaVWtpRFRFd05IZ3hNRFJlQmpvR1JWUTZFR0YxZEc5ZmIzSnBaVzUwVkRvTVozSmhkbWwwZVVraUMyTmxiblJsY2dZN0IxUT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--cccc2840663003c8560dd0321607ac1c663d4500/IMG-20200426-WA0002.jpg)"
            >
          </div>
          <div class="name-spkr-120 tlk-blob-name">Joshua Summers</div>
          <div class="tlk-blob-date">16:05, 27 Jul 20</div>
        </div>
        <div class="spkr-color-120">
          <div class="msg-70" target="spkr-color-">
            <div class="tlk-blob-msg"><div class="trix-content">
  <div class="tlk-bubble-holder"><div class="tlk-bubble">I just made this:</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">
<span>ï»¿</span><action-text-attachment sgid="BAh7CEkiCGdpZAY6BkVUSSI5Z2lkOi8vdGFhYWxrLWVkZ2UvQWN0aXZlU3RvcmFnZTo6QmxvYi8yMTQ_ZXhwaXJlc19pbgY7AFRJIgxwdXJwb3NlBjsAVEkiD2F0dGFjaGFibGUGOwBUSSIPZXhwaXJlc19hdAY7AFQw--39378b616b39b993c753caa90d668eb2855b5ad8" content-type="image/png" url="https://taaalk.co/rails/active_storage/blobs/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBZFk9IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ae0293fa23f49a667dde2118a9cc0886e4289efe/image.png" filename="image.png" filesize="62086" width="570" height="556" previewable="true" presentation="gallery"><figure class="attachment attachment--preview attachment--png">
    <img src="https://taaalk.co/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBBZFk9IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--ae0293fa23f49a667dde2118a9cc0886e4289efe/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VY21WemFYcGxYM1J2WDJ4cGJXbDBXd2RwQWdBRWFRSUFBdz09IiwiZXhwIjpudWxsLCJwdXIiOiJ2YXJpYXRpb24ifX0=--49a1b3a84cee51a7afa24b1e4856d59312b48236/image.png">

  <figcaption class="attachment__caption">
      <span class="attachment__name">image.png</span>
      <span class="attachment__size">60.6 KB</span>
  </figcaption>
</figure></action-text-attachment><span>ï»¿</span>
</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">Which explains the current relations.</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">I guess if it is the case that a Spkr has a Msg, and a Tlk has a Spkr, does it make any difference if a Tlk has a Msg? Or was that just a wasted line of code?</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">(Controllers after this.)</div></div>
</div>

            </div>
          </div>
        </div>
      </div>
      <div class="tlk-blob tlk-blob-left" id="5" >
        <div class="tlk-blob-spkr">
          <div class="tlk-tlking-image spkr-image image-spkr-122"
              style="background-image: url(https://taaalk.co/assets/user-fb72496d9b86b96d0eaa9cb88d48193837d6d2693e24a554c078f5a78c7a86d9.svg)"
            >
          </div>
          <div class="name-spkr-122 tlk-blob-name">Jaryl Sim</div>
          <div class="tlk-blob-date">08:28, 28 Jul 20</div>
        </div>
        <div class="spkr-color-122">
          <div class="msg-10" target="spkr-color-">
            <div class="tlk-blob-msg"><div class="trix-content">
  <div class="tlk-bubble-holder"><div class="tlk-bubble">Agreed with Kent that this model isn't all that bad, but one improvement would be to move some of that `spkrs` code out of the model. At the very least, you can implement them as named scopes, but for me what I like to do is to move these ancillary code into presenters or decorators first.</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">If the code does indeed prove to be used in a lot of places, then I'd consider moving them into the model as a first class concern. Although this may be indicative of coupling that you can work to remove.</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">If this is more of an academic thing, I suggest refactoring now rather than later. Otherwise, it's really not a showstopper at this point. The associations lookÂ </div></div>
</div>

            </div>
          </div>
        </div>
      </div>
      <div class="tlk-blob tlk-blob-left" id="6" >
        <div class="tlk-blob-spkr">
          <div class="tlk-tlking-image spkr-image image-spkr-120"
              style="background-image: url(/rails/active_storage/representations/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaHBYdz09IiwiZXhwIjpudWxsLCJwdXIiOiJibG9iX2lkIn19--b12355bc47dd05a966918b8f6edea2442e056d46/eyJfcmFpbHMiOnsibWVzc2FnZSI6IkJBaDdCam9VWTI5dFltbHVaVjl2Y0hScGIyNXpld2c2QzNKbGMybDZaVWtpRFRFd05IZ3hNRFJlQmpvR1JWUTZFR0YxZEc5ZmIzSnBaVzUwVkRvTVozSmhkbWwwZVVraUMyTmxiblJsY2dZN0IxUT0iLCJleHAiOm51bGwsInB1ciI6InZhcmlhdGlvbiJ9fQ==--cccc2840663003c8560dd0321607ac1c663d4500/IMG-20200426-WA0002.jpg)"
            >
          </div>
          <div class="name-spkr-120 tlk-blob-name">Joshua Summers</div>
          <div class="tlk-blob-date">12:34, 28 Jul 20 (edit: 18:24, 28 Jul 20)</div>
        </div>
        <div class="spkr-color-120">
          <div class="msg-70" target="spkr-color-">
            <div class="tlk-blob-msg"><div class="trix-content">
  <div class="tlk-bubble-holder"><div class="tlk-bubble"><blockquote>Agreed with Kent that this model isn't all that bad, but one improvement would be to move some of that `spkrs` code out of the model. At the very least, you can implement them as <strong>named scopes</strong>, but for me what I like to do is to move these ancillary code into <strong>presenters</strong> or <strong>decorators</strong> first.</blockquote></div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">OK cool, this is an area where I am totally lost as I don't really know much about named scopes, presenters or decorators. I've done some reading to try to understand and apply what you said. Here are my efforts:</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble"><strong>Named Scopes:</strong></div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">I read:Â </div></div><div class="tlk-bubble-holder"><div class="tlk-bubble"><ul>
<li><a href="https://www.ducktypelabs.com/using-scope-with-associations/">https://www.ducktypelabs.com/using-scope-with-associations/</a></li>
<li><a href="https://stackoverflow.com/questions/11636541/use-a-scope-by-default-on-a-rails-has-many-relationship">https://stackoverflow.com/questions/11636541/use-a-scope-by-default-on-a-rails-has-many-relationship</a></li>
</ul></div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">I am going to use this method as an example:</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble"><pre>  def non_hidden_spkrs
    spkrs.where(hide: false).sort_by(&amp;:created_at)
  end</pre></div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">My conclusion from reading the two posts was that the neatest solution would be:</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble"><pre># spkr.rb
class Spkr &lt; ActiveRecord::Base
  scope :non_hidden, where(hide: false).sort_by(&amp;:created_at)
end

# tlk.rb
calss Tlk &lt; ActiveRecord::Base
  has_many :spkrs, dependent: :destroy

  def non_hidden_spkrs
    spkrs.non_hidden
  end
end</pre></div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">This is because it seems that if scoping on a has_many attribute of a model there is not a way to have the has_many association AND a scope within the parent (belongs_to) model (at least none of the examples have it). I could do:</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble"><pre># Tlk.rb
calss Tlk &lt; ActiveRecord::Base
  has_many :spkrs, -&gt; { where(hide: false).sort_by(&amp;:created_at) }, dependent: :destroy
end</pre></div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">But this has two problems:</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble"><ol>
<li>When I call .spkrs I only get those where hide == false, but I want them all.</li>
<li>When I destroy a Taaalk, it only destroys speakers where hide == false (see <a href="https://github.com/rails/rails/issues/26111">https://github.com/rails/rails/issues/26111</a>)</li>
</ol></div></div><div class="tlk-bubble-holder"><div class="tlk-bubble"><strong>Presenters &amp; Decorators</strong></div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">I read:</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble"><ul>
<li><a href="https://medium.com/@kosovacsedad/ruby-on-rails-decorator-design-pattern-b54a1afd03c8">https://medium.com/@kosovacsedad/ruby-on-rails-decorator-design-pattern-b54a1afd03c8</a></li>
<li><a href="https://blog.appsignal.com/2019/04/30/ruby-magic-hidden-gems-delegator-forwardable.html">https://blog.appsignal.com/2019/04/30/ruby-magic-hidden-gems-delegator-forwardable.html</a></li>
<li><a href="https://thepugautomatic.com/2014/03/draper/">https://thepugautomatic.com/2014/03/draper/</a></li>
</ul></div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">This feels a lot more daunting to me than scopes! After reading about both presenters and decorators, presenters seemed to be the most friendly to me so I went with that (the third link got me to a not-too-intimidating place).</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">I would:</div></div><div class="tlk-bubble-holder"><div class="tlk-bubble"><pre>#app/presenters/tlk_presenter.rb
class TlkPresenter
  def initialize(tlk)
    @tlk = tlk
  end

  def non_hidden_spkrs
    @tlk.spkrs.where(hide: false).sort_by(&amp;:created_at)
  end

  private

  attr_reader :tlk
end

# app/controllers/tlks_controller.rb
class TlksController &lt; ApplicationController
  def show
    @tlk = Tlk.friendly.find(params[:id])
    @tlk_presenter = TlkPresenter.new(@tlk)
  end
end

# app/views/tlks/show.html.erb
&lt;% @tlk_presenter.non_hidden_spkrs.each do |spkr| %&gt;
  ...
&lt;% end %&gt;</pre></div></div><div class="tlk-bubble-holder"><div class="tlk-bubble"><strong>Final Thoughts/Questions</strong></div></div><div class="tlk-bubble-holder"><div class="tlk-bubble">Is my execution of these concepts right? And I feel like the use of scopes makes the most sense here and is neatest. Is that what you feel too?</div></div>
</div>

            </div>
          </div>
        </div>
      </div>

  </div>



<div class="tlk-container">
  <div class="big-white-split big-blue-split-bottom"></div>
</div>


<div class="tlk-container">




</div>

  <div class="tlk-follow-div">
    <div class="tlk-container">
    <a class="tlk-follow-link link-txt" data-remote="true" rel="nofollow" data-method="post" href="/tlks/72/tlk_follows?spkrs_follow=true">
    Follow this Taaalk
</a>    <div class="tlk-note tlk-follow-note">
      <p>5 followers</p>
    </div>
    <div class="tlk-note tlk-follow-note tlk-views-note" style="margin-left: 3px;">
      <p>1,630 views</p>
    </div>
</div>

</div>

  <div class="tlk-btm-follow-spacer"></div>

<div class="tlk-container anyone-tlk-container-2">
  <a class="link-txt" href="/start-conversation">Start your own Taaalk</a>,
  <a class="link-txt" href="/start-conversation">leave your details</a> or
  <a class="link-txt" href="/start-conversation">meet someone</a>
  to Taaalk with.
</div>



    </div>
    <div class="bg-footer div-footer">
    <div class="narrow-div-footer internal-div-footer">
    <a class="navbar-brand tlk-brand" href="/">Taaa<span class='fc-logo'>l</span>k</a>
    <div class="taaalk-about josh-info-closed">
      <p><strong>So why did Taaalk get built?</strong></p>
      <p>The world is filled with people who know lots of cool stuff and weird things. When it comes to interviews, traditionally it's been the case that a journalist has to take an interest in what you do before you get one. That doesn't happen too often, so it's probablyÂ the case that the world is under-interviewed. TaaalkÂ is here to change that. INTERVIEWS FOR EVERYONE.</p>
      <p>But the word "interview" doesn't really capture what TaaalkÂ is about. It's a bit too formal, and implies there is one person with all the knowledge (the interviewee) and another person getting it from them (the journalist/interviewer). TaaalkÂ can be used more flexiblyÂ than that. Four people (a TaaalkÂ can have any number of people) who know a lot about a subject can have an extremely nerdy and detailed Taaalk about it. Three people who don't know too much about anything can blab away to each other, just because they enjoy blabbing. And you don't even need to invite anyone to your Taaalk, if you want to write a poem every day, or share a continuousÂ stream of thoughts about a subject of your choice, you can use Taaalk as a place to do that; monologues are a-ok.</p>
      <p>And TaaalkÂ is built for you to be even more creative than that. You can invite yourself to your own Taaalk, change the second-you's details and have an imaginary conversation. You can invite yourself to a Taaalk any number of times, and write a whole play made up of the dialogue of imaginary characters.Â </p>
      <p><strong>If you don't have anyone to TaaalkÂ with today</strong>, you can leave your details on the <a href="/start-conversation">Start a Conversation</a> page. This means someone looking to TaaalkÂ can introduce themselves to you. And you can introduce yourself to someone else who has left their details.</p>
      <p>More seriously, <strong>we have all grown up in a digital world thatÂ is a bit awkward</strong>. In the real world you don't walk around shouting out random facts and opinions, instead you talk to people. And in the real world while you're talking, hundreds of random people don't jump into your conversation. The best chats have a healthy level of intimacy. TaaalkÂ tries to recreate these real world properties online. Firstly, it is all about talking (taaalking). Back and forths. This makes things feel a bit more natural than shouting out snip-its of thoughts and ideas. There's also no character limit and you can save drafts before you reply, so it's a place for deep conversations. You might find that you enjoy TaaalkingÂ even if you have normally found yourself to be a bit too shy to fully enjoy other platforms. Secondly, though anyone can read a Taaalk, only the people the "TaaalkÂ Owner" (the person who started the Taaalk) chooses can join in the conversation. This keeps things intimate.</p>
      <p><strong>What you say matters (and might embarrass you).</strong> Because of this TaaalkÂ comes with features to make you feel safe sharing your thoughts. Firstly, even if you are not the TaaalkÂ Owner, you can leave a Taaalk and delete all your messages at the same time. The Taaalk will still exist, but what you've written will not. If you are a TaaalkÂ Owner you can delete your Taaalk at any time. You can delete your account, deleting all messages you've written on the Taaalk platform and all the Taaalks you've started at the same time. It's possible to edit or delete an individual message after you have written it. And because it's possible to edit a message after someone has responded to it, we flag up when a message has been edited, so if you are the responder, you don't have to worry about someone changing the question after you've written a response to it. We hope these measures make you feel safe to share yourself on Taaalk, and if you have any more ideas, please come to the <a href="/t/taaalk-feedback">TaaalkÂ feedback conversation</a> to discuss them.</p>
    </div>
    <p id="taaalk-read-about">About</p>
    <script type="text/javascript">
      var taaalkAbout = document.querySelector('.taaalk-about');
      var taaalkAboutBtn = document.querySelector('#taaalk-read-about')
      taaalkAboutBtn.addEventListener('click', (event) => {
        taaalkAbout.classList.toggle('josh-info-closed');
        if (taaalkAboutBtn.innerText == 'About') {
          taaalkAboutBtn.innerText = 'Show less'
        } else {
          taaalkAboutBtn.innerText = 'About'
        }
      });
    </script>
    <p><a href="/t/taaalk-feedback">Feedback</a></p>

    <!-- <div class="josh-info josh-info-closed">
      <p>Hi, my name is Joshua and I built and designed Taaalk. I'm a product focused full stack developer and before that I was an analyst at one of Europe's top VC funds. I'm looking to be employed in either field, so please <a href="mailto:eichler [dot] summers [at] gmail [dot] com">get in touch with me</a> if you're hiring.</p>
      <p><strong>Other projects:</strong></p>
      <p>I write about psychology and technology.</p>
      <p><strong>Psychology: </strong><a href="https://psyarxiv.com/k6trz">https://psyarxiv.com/k6trz</a> - [Paper] A Suggestion for a New Interpretation of Dreams: Dreaming Is the Inverse of Anxious Mind-Wandering.</p>
      <p><strong>Psychology: </strong>(Coming soon) [Book] The Mechanics of Mental Health. <a href="https://twitter.com/JoshSummers1234">Follow me on Twitter</a> for updates.</p>
      <p><strong>Technology: </strong>(Coming soon) [Book] How to Analyse Like a Venture Capitalist. <a href="https://twitter.com/JoshSummers1234">Twitter</a> for updates.</p>
    </div>
    <p id="josh-read-more">Hire me & see my other projects</p>
    <script type="text/javascript">
      var joshInfo = document.querySelector('.josh-info');
      var joshInfoBtn = document.querySelector('#josh-read-more')
      joshInfoBtn.addEventListener('click', (event) => {
        joshInfo.classList.toggle('josh-info-closed');
        if (joshInfoBtn.innerText == 'Hire me & see my other projects') {
          joshInfoBtn.innerText = 'Show Less'
        } else {
          joshInfoBtn.innerText = 'Hire me & see my other projects'
        }
      });
    </script> -->
    <p class="opacity07">By using this website you agree to our:</p>
    <p><a href="/privacy">Privacy Policy</a> <span class="opacity07">and</span> <a href="/terms">Terms of Service</a></p>
  </div>
</div>

    <script src="/packs/js/on_new_page-72c58be62c1dcc8a1a70.js"></script>
  </body>
</html>
